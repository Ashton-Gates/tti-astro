---
// src/pages/api/testredis.astro
import { getRedisClient } from '../../lib/redis.js';

let message = 'Build mode â€” no Redis!';

if (import.meta.env.MODE !== 'build') {
  const redis = await getRedisClient();
  await redis.set('astro_test', 'success');
  const val = await redis.get('astro_test');
  message = `Redis says: ${val}`;
}
---

<html>
  <body>
    <h1>{message}</h1>
  </body>
</html>